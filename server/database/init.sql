-- 创建数据库（如果不存在）
CREATE DATABASE IF NOT EXISTS tjbuilding DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

USE tjbuilding;

-- 创建知识库表
CREATE TABLE IF NOT EXISTS knowledge_base (
  id INT AUTO_INCREMENT PRIMARY KEY,
  question VARCHAR(500) NOT NULL COMMENT '问题',
  answer TEXT NOT NULL COMMENT '答案',
  keywords VARCHAR(1000) DEFAULT '' COMMENT '关键词，用逗号分隔',
  category VARCHAR(50) DEFAULT '默认' COMMENT '分类',
  is_suggested TINYINT(1) DEFAULT 0 COMMENT '是否作为推荐问题',
  is_active TINYINT(1) DEFAULT 1 COMMENT '是否启用',
  sort_order INT DEFAULT 0 COMMENT '排序顺序',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  INDEX idx_category (category),
  INDEX idx_active (is_active),
  INDEX idx_suggested (is_suggested)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='知识库表';

-- 插入初始数据
INSERT INTO knowledge_base (question, answer, keywords, category, is_suggested, sort_order) VALUES
('这个系统有什么功能？', 
'新智楼宇能耗大屏系统主要功能包括：\n1. 实时能耗数据监控 - 显示当前温度、设备数量、用电量等实时信息\n2. 多维度数据分析 - 提供日/周/月/年的用电量统计和分析\n3. 分楼层房间管理 - 展示各楼层房间的详细能耗信息（室温、用电量、总功率、占用时长）\n4. 用电量分析 - 区分照明和空调的用电情况，支持当天/当月查看\n5. 设备用电排行 - 显示空调用电和照明用电的排行榜\n6. AI节能效果分析 - 提供节能效果分析和趋势预测\n7. 报警趋势监控 - 实时监控报警趋势，支持当天/当周/本年度切换',
'功能,做什么,用途,作用,能干什么',
'功能', 1, 1),

('如何查看能耗数据？',
'您可以通过以下方式查看能耗数据：\n1. 左列显示当前状态和用电量统计（日/月/周/年）\n2. 中间列展示各楼层房间的详细能耗信息\n3. 右列提供用电量分析、设备排行和报警趋势\n4. 点击AI节能效果分析可以查看详细的节能数据分析\n5. 所有图表都支持不同时间段的切换查看',
'数据,统计,查看,查询,显示',
'使用', 1, 2),

('如何理解用电量数据？',
'用电量数据说明：\n1. 总用电量：显示选定时间段内的总用电量（单位：度）\n2. 空调用电：空调设备的用电量，通常占总用电量的较大比例\n3. 照明用电：照明设备的用电量\n4. 非工作时段用电占比：显示非工作时间段的用电情况，帮助识别节能空间\n5. 设备用电排行：可以查看哪些设备或房间用电量最高\n6. 建议：关注高用电量房间和设备，制定节能策略',
'用电量,能耗,电量,消耗,用电',
'数据解读', 1, 3),

('如何节能降耗？',
'节能降耗建议：\n1. 关注非工作时段用电占比，及时关闭不必要的设备\n2. 查看设备用电排行，重点优化高耗能设备\n3. 利用AI节能效果分析，了解节能措施的实际效果\n4. 根据报警趋势，及时发现异常用电情况\n5. 合理设置空调温度，避免过度制冷或制热\n6. 使用智能照明系统，根据自然光自动调节\n7. 定期查看能耗趋势，制定长期节能计划',
'节能,省电,优化,降低,减少',
'节能', 1, 4),

('如何查看房间能耗信息？',
'查看房间能耗信息：\n1. 中间列显示所有楼层和房间的列表\n2. 每个房间显示：室温、用电量、总功率、占用时长等信息\n3. 特殊房间会高亮显示（如高耗能房间）\n4. 可以点击AI节能效果分析，选择特定房间查看详细数据\n5. 支持按房间筛选查看不同时间段的能耗数据',
'房间,楼层,办公室,位置',
'使用', 1, 5),

('如何理解各种图表？',
'图表说明：\n1. 饼图：显示非工作时段用电占比，帮助识别节能空间\n2. 柱状图：显示近7天设备用电量，便于对比分析\n3. 堆叠柱状图（AI分析）：显示空调、照明、节能的用电分布\n4. 环形图：显示总用电量和节能百分比\n5. 横向柱状图：显示空调用电和照明用电排行\n6. 折线图：显示报警趋势，支持当天/当周/本年度切换\n7. 所有图表都支持交互，鼠标悬停可查看详细数据',
'图表,图形,趋势,分析,可视化',
'数据解读', 1, 6),

('如何切换查看不同时间段的数据？',
'切换时间段：\n1. 用电量统计支持：日/月/周/年四个时间段\n2. AI节能效果分析支持：当天/当周/当月/本年度切换\n3. 报警趋势支持：当天/当周/本年度切换\n4. 点击相应的时间标签按钮即可切换\n5. 切换后，所有相关图表和数据会自动更新',
'时间,时间段,日期,周期,切换',
'使用', 1, 7),

('如何查看报警信息？',
'查看报警信息：\n1. 右列有"报警趋势"图表\n2. 显示报警数量的趋势变化\n3. 支持切换查看：当天/当周/本年度\n4. 通过折线图可以直观看到报警频率和趋势\n5. 如果发现异常报警，建议及时检查相关设备或房间\n6. 结合用电量数据，可以分析报警与能耗的关系',
'报警,异常,警告,问题,故障',
'使用', 0, 8),

('这个系统使用什么技术？',
'技术栈：\n1. 前端框架：React 18 + TypeScript\n2. 构建工具：Vite\n3. 图表库：ECharts (echarts-for-react)\n4. 图标库：react-icons\n5. 响应式设计，支持不同屏幕尺寸\n6. 现代化UI设计，提供良好的用户体验',
'技术,系统,架构,实现,开发',
'技术', 0, 9),

('您好，我需要帮助',
'您好！我是新智楼宇能耗大屏的智能助手。我可以帮您解答关于能耗监控、数据分析、功能使用等方面的问题。\n\n您可以问我：\n- 系统有哪些功能？\n- 如何查看能耗数据？\n- 如何理解用电量数据？\n- 如何节能降耗？\n- 如何查看房间信息？\n- 图表如何理解？\n- 如何切换时间段？\n\n请随时提问！',
'你好,帮助,hello,hi,您好',
'默认', 0, 0);


